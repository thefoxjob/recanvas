var z=Object.defineProperty,j=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var N=(e,n,t)=>n in e?z(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,l=(e,n)=>{for(var t in n||(n={}))y.call(n,t)&&N(e,t,n[t]);if(g)for(var t of g(n))w.call(n,t)&&N(e,t,n[t]);return e},x=(e,n)=>j(e,q(n));var p=(e,n)=>{var t={};for(var r in e)y.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&g)for(var r of g(e))n.indexOf(r)<0&&w.call(e,r)&&(t[r]=e[r]);return t};import{createContext as ne,createElement as B,useContext as re,useEffect as te,useRef as A}from"react";import Q from"react-reconciler";import{DefaultEventPriority as F}from"react-reconciler/constants";function C(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)}function M(e,n){if(n.nodeName)switch(n.nodeName){case"canvas-view":{let{x:t,y:r,width:o,height:i,style:a}=n.props;e.fillStyle=(a==null?void 0:a.color)||"black",e.fillRect(t,r,o,i);break}default:console.log("appendChild - not implemented",n)}}var f=(...e)=>{},m=(...e)=>{throw new Error("Function not implemented.")},h,s={},G=0,P={isPrimaryRenderer:!1,getPublicInstance:e=>e,getInstanceFromScope:(...e)=>m(...e),getInstanceFromNode:(...e)=>m(...e),getCurrentEventPriority:()=>F,getRootHostContext:e=>(h||(h=e.canvas),C(e),null),getChildHostContext:()=>({}),shouldSetTextContent:()=>!1,createInstance:K,createTextInstance:(...e)=>m(...e),appendInitialChild:m,prepareForCommit:f,resetAfterCommit:f,prepareUpdate:U,finalizeInitialChildren:()=>!1,preparePortalMount:f,prepareScopeUpdate:(...e)=>m(...e),beforeActiveInstanceBlur:(...e)=>m(...e),afterActiveInstanceBlur:(...e)=>m(...e),detachDeletedInstance:_,noTimeout:-1,scheduleTimeout:setTimeout,cancelTimeout:clearTimeout,supportsMutation:!1,supportsHydration:!1,supportsPersistence:!0,createContainerChildSet:e=>e,appendChildToContainerChildSet:M,finalizeContainerChildren:f,replaceContainerChildren:f,cloneInstance:W,cloneHiddenInstance:(...e)=>m(...e),cloneHiddenTextInstance:(...e)=>m(...e)};function K(e,n){let t={},r=(G++).toString();s[r]={},Object.entries(n).forEach(([i,a])=>{i.slice(0,2)==="on"&&(t[i.slice(2).toLowerCase()]=a)});let o={id:r,nodeName:e,props:n,childNodes:[],eventHandlers:t};return O(o,n),o}function U(e,n,t,r,o){return C(o),Object.entries(r||t).forEach(([i,a])=>{i.slice(0,2)==="on"&&(e.eventHandlers[i.slice(2).toLowerCase()]=a)}),{ctx:o,props:r}}function W(e,n){return O(e,n.props),l(l({},e),n)}function _(e){let{eventHandlers:n,id:t}=e;Object.entries(n).forEach(([r])=>{var o;(o=s==null?void 0:s[t])!=null&&o[r]&&h.removeEventListener(r,s[t][r])}),delete s[t]}function O(e,n){let{eventHandlers:t,id:r}=e;Object.entries(t).forEach(([o,i])=>{var d;let a=u=>{(J(u,n)||o.includes("key"))&&i(u)};(d=s==null?void 0:s[r])!=null&&d[o]&&h.removeEventListener(o,s[r][o]),s[r][o]=a,h.addEventListener(o,a)})}function J(e,n){let t=e.offsetX,r=e.offsetY,{x:o=0,y:i=0,width:a=0,height:d=0}=n;return t>o&&t<=o+a&&r>i&&r<=i+d}var D,T=Q(P);function I(e,n,t){D=T.createContainer(n.getContext("2d"),0,null,!1,!1,"Recanvas",()=>{},null),T.updateContainer(e,D,null,t)}import{createElement as Z}from"react";function Me(t){var r=t,{children:e}=r,n=p(r,["children"]);return Z("canvas-image",n,e)}import{createElement as $}from"react";function X(t){var r=t,{children:e}=r,n=p(r,["children"]);return $("canvas-text",n,e)}X.defaultProps={children:void 0,style:void 0};import{createElement as Y}from"react";function ee(t){var r=t,{children:e}=r,n=p(r,["children"]);return Y("canvas-view",n,e)}ee.defaultProps={children:void 0,onClick:void 0,onKeyDown:void 0};import{useCallback as E,useEffect as H,useRef as v}from"react";function je(e,n=0,t){let r=v(void 0),o=v(0),i=v(e),a=E(()=>{r.current=requestAnimationFrame(u=>{u-o.current>n&&(o.current=u,i.current(u)),t||a()})},[n,t]),d=E(()=>{r.current&&cancelAnimationFrame(r.current)},[]);H(()=>{i.current=e},[e]),H(()=>(a(),()=>d()),[a,d])}var R=(c=>(c.Monospace="monospace",c.Serif="serif",c.SansSerif="sans-serif",c.Arial="Arial",c.Verdana="Verdana",c.Times="Times New Roman",c.Georgia="Georgia",c.BrushScript="Brush Script MT",c.Courier="Courier New",c))(R||{}),L=(o=>(o.Normal="normal",o.Bold="bold",o.Bolder="bolder",o.Lighter="lighter",o))(L||{}),S=(r=>(r.Normal="normal",r.Italic="italic",r.Oblique="oblique",r))(S||{}),V=(t=>(t.Normal="normal",t.SmallCaps="small-caps",t))(V||{});var k=ne(void 0);function Ue(e,n){let t=A(null),r=A(!1),{height:o,width:i}=n;return te(()=>{t.current&&!r.current&&(I(B(k.Provider,{value:x(l({},n),{canvasElement:t.current})},e),t.current),r.current=!0)},[t]),function(a){return B("canvas",x(l({},a),{ref:t,height:o,width:i,tabIndex:0}))}}function We(){let e=re(k);if(!e)throw new Error("The hook can only be used inside a Canvas.");return e}export{Me as Image,R as RecanvasFontFamily,S as RecanvasFontStyle,V as RecanvasFontVariant,L as RecanvasFontWeight,X as Text,ee as View,je as useAnimationFrame,Ue as useCanvas,We as useCanvasOptions};
